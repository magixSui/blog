<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>配置 | MAGIX</title>
    <meta name="description" content="Just playing around">
    
    
    <link rel="preload" href="/blog/assets/css/0.styles.525afb02.css" as="style"><link rel="preload" href="/blog/assets/js/app.a27d9b4a.js" as="script"><link rel="preload" href="/blog/assets/js/91.dc4ee324.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.e5fc52b3.js"><link rel="prefetch" href="/blog/assets/js/11.f0ac34ec.js"><link rel="prefetch" href="/blog/assets/js/12.e4b592f8.js"><link rel="prefetch" href="/blog/assets/js/13.48abd9d3.js"><link rel="prefetch" href="/blog/assets/js/14.38f5c2ca.js"><link rel="prefetch" href="/blog/assets/js/15.25bc1de2.js"><link rel="prefetch" href="/blog/assets/js/16.0803ce76.js"><link rel="prefetch" href="/blog/assets/js/17.6cb0eed4.js"><link rel="prefetch" href="/blog/assets/js/18.8e539aaa.js"><link rel="prefetch" href="/blog/assets/js/19.643135b8.js"><link rel="prefetch" href="/blog/assets/js/2.7e912fa8.js"><link rel="prefetch" href="/blog/assets/js/20.82ea9b3b.js"><link rel="prefetch" href="/blog/assets/js/21.7e1a5311.js"><link rel="prefetch" href="/blog/assets/js/22.ad24dd81.js"><link rel="prefetch" href="/blog/assets/js/23.8ba939be.js"><link rel="prefetch" href="/blog/assets/js/24.0883873b.js"><link rel="prefetch" href="/blog/assets/js/25.40ffec94.js"><link rel="prefetch" href="/blog/assets/js/26.dd06200e.js"><link rel="prefetch" href="/blog/assets/js/27.83a1db1b.js"><link rel="prefetch" href="/blog/assets/js/28.9615f900.js"><link rel="prefetch" href="/blog/assets/js/29.36f1cfce.js"><link rel="prefetch" href="/blog/assets/js/3.4b16f1f2.js"><link rel="prefetch" href="/blog/assets/js/30.f8c575dd.js"><link rel="prefetch" href="/blog/assets/js/31.d3e2d452.js"><link rel="prefetch" href="/blog/assets/js/32.41f03763.js"><link rel="prefetch" href="/blog/assets/js/33.13a0553c.js"><link rel="prefetch" href="/blog/assets/js/34.9f281720.js"><link rel="prefetch" href="/blog/assets/js/35.19b5467f.js"><link rel="prefetch" href="/blog/assets/js/36.0877d12d.js"><link rel="prefetch" href="/blog/assets/js/37.d2d03e5e.js"><link rel="prefetch" href="/blog/assets/js/38.e3fca828.js"><link rel="prefetch" href="/blog/assets/js/39.6b8ff286.js"><link rel="prefetch" href="/blog/assets/js/4.1e72d5f3.js"><link rel="prefetch" href="/blog/assets/js/40.80f74815.js"><link rel="prefetch" href="/blog/assets/js/41.4be4c4fb.js"><link rel="prefetch" href="/blog/assets/js/42.1395a0fb.js"><link rel="prefetch" href="/blog/assets/js/43.83652382.js"><link rel="prefetch" href="/blog/assets/js/44.aa295ed7.js"><link rel="prefetch" href="/blog/assets/js/45.3765fa51.js"><link rel="prefetch" href="/blog/assets/js/46.220f5097.js"><link rel="prefetch" href="/blog/assets/js/47.9aad9d09.js"><link rel="prefetch" href="/blog/assets/js/48.4294b04e.js"><link rel="prefetch" href="/blog/assets/js/49.9af13674.js"><link rel="prefetch" href="/blog/assets/js/5.f302f40c.js"><link rel="prefetch" href="/blog/assets/js/50.cf8af1b5.js"><link rel="prefetch" href="/blog/assets/js/51.b79530a2.js"><link rel="prefetch" href="/blog/assets/js/52.4fd7fc36.js"><link rel="prefetch" href="/blog/assets/js/53.bf95fe08.js"><link rel="prefetch" href="/blog/assets/js/54.d9f07ca2.js"><link rel="prefetch" href="/blog/assets/js/55.69590ec0.js"><link rel="prefetch" href="/blog/assets/js/56.f8e711ad.js"><link rel="prefetch" href="/blog/assets/js/57.aa2f9f1f.js"><link rel="prefetch" href="/blog/assets/js/58.522e3bf4.js"><link rel="prefetch" href="/blog/assets/js/59.7ca955ae.js"><link rel="prefetch" href="/blog/assets/js/6.908bb66d.js"><link rel="prefetch" href="/blog/assets/js/60.84be80a6.js"><link rel="prefetch" href="/blog/assets/js/61.7467b584.js"><link rel="prefetch" href="/blog/assets/js/62.935b960e.js"><link rel="prefetch" href="/blog/assets/js/63.7f852d61.js"><link rel="prefetch" href="/blog/assets/js/64.563b1b05.js"><link rel="prefetch" href="/blog/assets/js/65.e1c3ecc1.js"><link rel="prefetch" href="/blog/assets/js/66.a7fbc839.js"><link rel="prefetch" href="/blog/assets/js/67.0674daea.js"><link rel="prefetch" href="/blog/assets/js/68.c3b20341.js"><link rel="prefetch" href="/blog/assets/js/69.6c43a42d.js"><link rel="prefetch" href="/blog/assets/js/7.54f4cc8f.js"><link rel="prefetch" href="/blog/assets/js/70.0d125bc1.js"><link rel="prefetch" href="/blog/assets/js/71.8a983173.js"><link rel="prefetch" href="/blog/assets/js/72.a394f9ba.js"><link rel="prefetch" href="/blog/assets/js/73.a1dfa98f.js"><link rel="prefetch" href="/blog/assets/js/74.facd5788.js"><link rel="prefetch" href="/blog/assets/js/75.6b4f6931.js"><link rel="prefetch" href="/blog/assets/js/76.1d5e7152.js"><link rel="prefetch" href="/blog/assets/js/77.4e3371bb.js"><link rel="prefetch" href="/blog/assets/js/78.b8260cf7.js"><link rel="prefetch" href="/blog/assets/js/79.0fe606ac.js"><link rel="prefetch" href="/blog/assets/js/8.c715bb20.js"><link rel="prefetch" href="/blog/assets/js/80.eb3eb0ad.js"><link rel="prefetch" href="/blog/assets/js/81.3b6692ec.js"><link rel="prefetch" href="/blog/assets/js/82.e9272bb7.js"><link rel="prefetch" href="/blog/assets/js/83.3ee16800.js"><link rel="prefetch" href="/blog/assets/js/84.56cd2a4c.js"><link rel="prefetch" href="/blog/assets/js/85.570141db.js"><link rel="prefetch" href="/blog/assets/js/86.803bb949.js"><link rel="prefetch" href="/blog/assets/js/87.f111eeac.js"><link rel="prefetch" href="/blog/assets/js/88.5a6e4815.js"><link rel="prefetch" href="/blog/assets/js/89.1d657b1a.js"><link rel="prefetch" href="/blog/assets/js/9.e9a772d1.js"><link rel="prefetch" href="/blog/assets/js/90.a8481b4b.js"><link rel="prefetch" href="/blog/assets/js/92.67039dc0.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.525afb02.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">MAGIX</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/javascript/" class="nav-link">博客</a></div><div class="nav-item"><a href="https://github.com/magicxin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/javascript/" class="nav-link">博客</a></div><div class="nav-item"><a href="https://github.com/magicxin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>javascript</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>vue 3.0</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>vue 源码学习</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>vue</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>nodejs</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>v8</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>typescript</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>网络协议</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>git</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>three.js</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>解决方案</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>linux</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>系统架构设计师</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>前端架构</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>android</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>science</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>翻译</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>技术入门</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>webpack 配置</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/blog/webpack/config.html" class="active sidebar-link">配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#从基础搭建一个基于-vue-的单页应用" class="sidebar-link">从基础搭建一个基于 vue 的单页应用</a></li><li class="sidebar-sub-header"><a href="/blog/webpack/config.html#babel-polyfill" class="sidebar-link">babel-polyfill</a></li></ul></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>草稿箱</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="配置"><a href="#配置" class="header-anchor">#</a> 配置</h1> <p>webpack 配置是前段工程化一个难点。随着前端项目要求的提高，单独靠个人手动处理很难面面俱到，引用工具是一个不可避免的过程。
webpack 就是其中一款项目级、出色的全面的工具。不论是项目、库、框架、插件都可以通过 webpack 工具加工，达到自己开发期和构建
期想要的结果。强大必然避免不了复杂，webpack 的配置相对于其他工具还是有一定上手难度。</p> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>文章书写时 webpack ^4.39.2 webpack-cli ^3.3.7 , 使用 webpack 的一个禁忌可能就是避免从各种博客文档上直接复制粘贴配置，webpack
的版本变化引起的 api 、 插件 api 变化很大，如果没有梳理清楚其中的功能作用很容易就会出错，就连 webpack 官方中文文档上也存在大量
新版本失效的配置方式。遇到错误时，尽量在当前使用的插件官方 doc 查看解决办法。</p></div> <h2 id="从基础搭建一个基于-vue-的单页应用"><a href="#从基础搭建一个基于-vue-的单页应用" class="header-anchor">#</a> 从基础搭建一个基于 vue 的单页应用</h2> <h3 id="零配置"><a href="#零配置" class="header-anchor">#</a> 零配置</h3> <p>webpack4 支持零配置，直接执行 npx webpack 会在 dist 目录下生成 main.js 文件，默认的文件入口是 <code>./src/index.js</code></p> <div class="language- extra-class"><pre class="language-text"><code>|-dist
    |-main.js
    |-index.html
|-src
    |-index.js
</code></pre></div><h3 id="自定义配置"><a href="#自定义配置" class="header-anchor">#</a> 自定义配置</h3> <p>项目中零配置无法满足项目需求，因此大多数情况需要自定义配置。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// webpack.config.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        app<span class="token punctuation">:</span> <span class="token string">'src/index.js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        filename<span class="token punctuation">:</span> <span class="token string">'bundle.js'</span>
        path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这样在 package.json 中配置</p> <div class="language-json extra-class"><pre class="language-json"><code>...
script<span class="token operator">:</span> <span class="token punctuation">{</span>
    build<span class="token operator">:</span> 'webpack'
<span class="token punctuation">}</span>
...
</code></pre></div><p>就可以在命令中执行 <code>npm build</code>，将文件打包到 dist 中。</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>webpack 默认支持 import 使用 import 来导入模块</p></div> <h3 id="style"><a href="#style" class="header-anchor">#</a> style</h3> <p>可以使用 style-loader 来支持样式的引入。样式有两种注入方式，第一种是注入 <code>&lt;style&gt;</code> 标签。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>style-loader 只具有注入 <code>&lt;style&gt;</code> 标签的功能，通常与 css-loader 一起使用，以保证具有 css 加载的能力。</p></div> <p>第二种是注入 <code>&lt;link&gt;</code> 标签。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
            options<span class="token punctuation">:</span> <span class="token punctuation">{</span>injectType<span class="token punctuation">:</span> <span class="token string">'linkTag'</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> <span class="token string">'file-loader'</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><h3 id="文件加载"><a href="#文件加载" class="header-anchor">#</a> 文件加载</h3> <p>可以使用 file-loader 加载图片、字体等文件。需要注意的是，css 中 background 等方式设置的路径，直接打包后并不能正确加载。这是因为
生成的文件目录和名称并不能匹配。可以通过设置 name 定位到打包的位置。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
                test<span class="token punctuation">:</span> <span class="token regex">/\.(png|svg|jpg|gif)$/</span><span class="token punctuation">,</span>
                use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
                    loader<span class="token punctuation">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
                    options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                        name<span class="token punctuation">:</span> <span class="token string">'assets/[name].[ext]?[hash]'</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span>

<span class="token punctuation">{</span>
                test<span class="token punctuation">:</span> <span class="token regex">/\.(woff|woff2|eot|ttf|otf)$/</span><span class="token punctuation">,</span>
                use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'file-loader'</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span>

</code></pre></div><h3 id="生成-html"><a href="#生成-html" class="header-anchor">#</a> 生成 html</h3> <p>到目前位置需要手动在 html 中配置一些生成信息。<code>html-webpack-plugin</code> 可以自动读取webpack中的依赖生成 index.html。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 定义模板会从模板目录 src/index 读取，否则会自动生成</span>
<span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            template<span class="token punctuation">:</span> <span class="token string">'src/index.html'</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><a href="https://github.com/jantimon/html-webpack-plugin/blob/master/docs/template-option.md" target="_blank" rel="noopener noreferrer">htmlWebpackPlugin 配置<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>配置 template 使模板从指定目录读取。</p></div> <h3 id="清理-dist-目录"><a href="#清理-dist-目录" class="header-anchor">#</a> 清理 dist 目录</h3> <p>由于每次生成的文件带有 hash 值，会导致文件目录越来越大，clean-webpack-plugin 可以在每次生成前删除目录。</p> <div class="language- extra-class"><pre class="language-text"><code>const { CleanWebpackPlugin } = require('clean-webpack-plugin');
plugins: [
        new CleanWebpackPlugin()
    ]
</code></pre></div><h3 id="开启-sourcemap"><a href="#开启-sourcemap" class="header-anchor">#</a> 开启 sourceMap</h3> <p>由于代码被处理和压缩，debug 就成了一个问题。sourceMap 可以解决 debug 的问题。对于 development 环境，可以设置：</p> <div class="language- extra-class"><pre class="language-text"><code>devtool: 'inline-source-map'
</code></pre></div><p>对于生产环境可以设置</p> <div class="language- extra-class"><pre class="language-text"><code>devtool: 'source-map'
</code></pre></div><h3 id="自动编译-热启动"><a href="#自动编译-热启动" class="header-anchor">#</a> 自动编译 热启动</h3> <p>有三种方式可以不重复 build 而实现修改后的内容实时变更。</p> <ul><li>watch mode</li> <li>webpack-dev-server</li> <li>webpack-dev-middleware</li></ul> <h3 id="hrm-热更新"><a href="#hrm-热更新" class="header-anchor">#</a> hrm 热更新</h3> <p>hrm 需要和 loader 配合使用</p> <div class="language- extra-class"><pre class="language-text"><code>const webpack = require('webpack');
plugins: [
        new webpack.NamedModulesPlugin(),
        new webpack.HotModuleReplacementPlugin()
    ]
</code></pre></div><h3 id="tree-shaking（删除未引用代码）"><a href="#tree-shaking（删除未引用代码）" class="header-anchor">#</a> tree-shaking（删除未引用代码）</h3> <p>package.json 下设置 sideEffects: false, 并且配置压缩插件。mode 是 production 会自动开启。
TODO</p> <h3 id="逻辑分离-不重复原则"><a href="#逻辑分离-不重复原则" class="header-anchor">#</a> 逻辑分离 不重复原则</h3> <p>分离 webpack.config.json，根据逻辑分离原则，创建两个新的 config 文件。<code>webpack.dev.js</code> 和 <code>webpack.prod.js</code>,根据不重复原则
创建第三个文件 <code>webpack.common.js</code> 利用 <code>webpack-merge</code> 插件合并配置。</p> <h3 id="代码压缩"><a href="#代码压缩" class="header-anchor">#</a> 代码压缩</h3> <p><code>mode: 'production'</code> 默认情况会开启压缩。有三种方式压缩代码：</p> <ul><li>UglifyJSPlugin</li> <li>BabelMinifyWebpackPlugin</li> <li>ClosureCompilerPlugin</li></ul> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>使用需要查看是否具有 tree-shaking 的能力</p></div> <h3 id="使用-cli"><a href="#使用-cli" class="header-anchor">#</a> 使用 cli</h3> <p>可以在控制台输入来开启一些配置，不过更推荐写入配置文件。</p> <div class="language- extra-class"><pre class="language-text"><code>--optimize-minimize # 开启 UglifyJSPlugin
--define process.env.NODE_ENV = &quot;'production'&quot; # 设置 mode production
webpack -p 
</code></pre></div><h3 id="code-split-代码分割"><a href="#code-split-代码分割" class="header-anchor">#</a> code-split 代码分割</h3> <p>有三种代码分割的方式</p> <ul><li>entry</li> <li>CommonsChunckPlugin</li> <li>动态导入
TODO</li></ul> <h3 id="配置代理"><a href="#配置代理" class="header-anchor">#</a> 配置代理</h3> <p>对于前后分离的项目，调试接口时一般需要配置 proxy 代理。</p> <div class="language- extra-class"><pre class="language-text"><code>devServer: {
        proxy: {
            '/api': {
                target: 'http://localhost:3000/community_manage/',
                pathRewrite: {'^/api' : ''},
                changeOrigin: true
            }
        },
    }
</code></pre></div><h2 id="babel-polyfill"><a href="#babel-polyfill" class="header-anchor">#</a> babel-polyfill</h2> <p>babel 只会转义一些 es6 语法相关的内容，对于很多特性是缺失的。因此在老旧的浏览器比如 ie11 ，babel-polyfill 就是必要的了。
首先有一种比较差的使用办法：</p> <div class="language- extra-class"><pre class="language-text"><code>npm install babel-polyfill
// 在文件主入口
import &quot;babel-polyfill&quot;
</code></pre></div><p>可以保证项目内的转义，但是如果引入的包中的源码使用了 es6 语法，那么这种方式就失效了，并且这种方式完全转义，会增加包的体积。</p> <p>1：安装 babel-polyfill</p> <div class="language- extra-class"><pre class="language-text"><code>npm install babel-polyfill
</code></pre></div><p>2: 拦截入口</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// webpack.config.js</span>
entry<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;babel-polyfill&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./src/main.js&quot;</span><span class="token punctuation">]</span>
</code></pre></div><p>3: 自定义范围</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    test<span class="token punctuation">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
    loader<span class="token punctuation">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
    include<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'/node_modules/element-ui/src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'/node_modules/element-ui/packages'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'node_modules/webpack-dev-server/client'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blog/utils/mongodb.html" class="prev">
          mongodb 入门
        </a></span> <span class="next"><a href="/blog/scratch-paper/import-vue.html">
          引入 vue
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/blog/assets/js/app.a27d9b4a.js" defer></script><script src="/blog/assets/js/91.dc4ee324.js" defer></script>
  </body>
</html>
