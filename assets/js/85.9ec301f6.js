(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{251:function(a,s,t){"use strict";t.r(s);var e=t(0),r=Object(e.a)({},(function(){var a=this.$createElement;this._self._c;return this._m(0)}),[function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("div",{staticClass:"content"},[t("h1",{attrs:{id:"rollup"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rollup"}},[a._v("#")]),a._v(" rollup")]),a._v(" "),t("p",[a._v("rollup 是新一代的打包工具。相对于 webpack rollup 具有更好的可读性，首个应用 tree-shaking 的打包器。并且 rollup 使用\n全新的 es module 标准编译代码模块，而不是使用 commonjs 等规范。")]),a._v(" "),t("h2",{attrs:{id:"项目创建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#项目创建"}},[a._v("#")]),a._v(" 项目创建")]),a._v(" "),t("p",[a._v("rollup 配置和使用更为简单，生成代码更易读，因此更适合库和插件的开发。\n首先创建配置文件：")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("npm init\n")])])]),t("p",[a._v("然后增加一个入口文件 "),t("code",[a._v("index.js")]),a._v("。\n安装 rollup")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("yarn add rollup -D\n")])])]),t("h3",{attrs:{id:"项目结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#项目结构"}},[a._v("#")]),a._v(" 项目结构")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("|--index\n|--rollup.config.js\n|--package.json\n")])])]),t("h2",{attrs:{id:"基本配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基本配置"}},[a._v("#")]),a._v(" 基本配置")]),a._v(" "),t("p",[a._v("rollup 可以使用命令行参数，但更通常的做法是通过配置文件执行。")]),a._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[a._v("module"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    input"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'index.js'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    external"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("''")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    plugins"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    output"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        file"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'dist/test.js'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n        format"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'umd'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n        name"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Seed'")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("h3",{attrs:{id:"global"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#global"}},[a._v("#")]),a._v(" global")]),a._v(" "),t("p",[a._v("globals 的值是一个对象，key表示使用的模块名称（npm 模块名），value 表示在打包文件中引用的全局变量名。")]),a._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[a._v("globals"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  vue"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Vue'")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("h3",{attrs:{id:"命令行"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#命令行"}},[a._v("#")]),a._v(" 命令行")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('//package.json\n"script": {\n    "build": "rollup -c"\n}\n')])])]),t("h2",{attrs:{id:"插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#插件"}},[a._v("#")]),a._v(" 插件")]),a._v(" "),t("p",[a._v("rollup 插件使用非常简单，只需要引入执行就可以了,根据不同插件的文档，传入不同的配置对象。")]),a._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[a._v("\n")])])]),t("h3",{attrs:{id:"rollup-plugin-node-resolve"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rollup-plugin-node-resolve"}},[a._v("#")]),a._v(" rollup-plugin-node-resolve")]),a._v(" "),t("p",[a._v("使 rollup 可以解析 mode_modules 的文件。")]),a._v(" "),t("h3",{attrs:{id:"rollup-plugin-commonjs"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rollup-plugin-commonjs"}},[a._v("#")]),a._v(" rollup-plugin-commonjs")]),a._v(" "),t("p",[a._v("使 rollup 可以解析 commonjs 规范的文件。")]),a._v(" "),t("h3",{attrs:{id:"rollup-plugin-json"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rollup-plugin-json"}},[a._v("#")]),a._v(" rollup-plugin-json")]),a._v(" "),t("p",[a._v("plugins: [\nplugin()\n],")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("yarn add rollup-plugin-json -D\n# rollup.config.js\nimport json from 'rollup-plugin-json';\nplugins: [json()],\n")])])]),t("p",[a._v("在文件中引入 json 就可以读取 json 数据了。")]),a._v(" "),t("div",{staticClass:"language-javasript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("import { version } from './package.json';\n\nconsole.log(version)\n")])])]),t("h3",{attrs:{id:"rollup-plugin-serve"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rollup-plugin-serve"}},[a._v("#")]),a._v(" rollup-plugin-serve")]),a._v(" "),t("p",[a._v("启动一个 server 服务")]),a._v(" "),t("h3",{attrs:{id:"rollup-plugin-generate-html-template"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rollup-plugin-generate-html-template"}},[a._v("#")]),a._v(" rollup-plugin-generate-html-template")]),a._v(" "),t("p",[a._v("拷贝 html 并自动写入 js。")]),a._v(" "),t("h3",{attrs:{id:"rollup-plugin-generate-html-template-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rollup-plugin-generate-html-template-2"}},[a._v("#")]),a._v(" rollup-plugin-generate-html-template")]),a._v(" "),t("p",[a._v("拷贝 html 并注入 js 脚本")]),a._v(" "),t("h3",{attrs:{id:"rollup-plugin-vue"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rollup-plugin-vue"}},[a._v("#")]),a._v(" rollup-plugin-vue")]),a._v(" "),t("p",[a._v("使 rollup 可以解析 .vue文件。")]),a._v(" "),t("h3",{attrs:{id:"rollup-plugin-postcss"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rollup-plugin-postcss"}},[a._v("#")]),a._v(" rollup-plugin-postcss")]),a._v(" "),t("p",[a._v("使 rollup 可以编译 css 并将内容写入到 style 标签。")]),a._v(" "),t("h3",{attrs:{id:"rollup-plugin-jsx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rollup-plugin-jsx"}},[a._v("#")]),a._v(" rollup-plugin-jsx")]),a._v(" "),t("p",[a._v("使 rollup 可以解析 .jsx 文件。")]),a._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("jsx")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v(" factory"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'h'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("h3",{attrs:{id:"rollup-plugin-buble"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rollup-plugin-buble"}},[a._v("#")]),a._v(" rollup-plugin-buble")]),a._v(" "),t("p",[a._v("类似于 babel ，可以提前使用一些 es6 + 的js。")]),a._v(" "),t("h2",{attrs:{id:"问题处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问题处理"}},[a._v("#")]),a._v(" 问题处理")]),a._v(" "),t("h3",{attrs:{id:"unresolved-dependencies"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#unresolved-dependencies"}},[a._v("#")]),a._v(" unresolved dependencies")]),a._v(" "),t("p",[a._v("通常是没有找到 mode_modules 下的外部依赖。解决方案：使用 'rollup-plugin-node-resolve'。\n但是我遇到的并不是常规的问题，原因是 "),t("code",[a._v("rollup-plugin-vue")]),a._v(" 的某些版本会报错，使用 "),t("code",[a._v("rollup-plugin-vue@5.1.1")]),a._v(" 后解决。\nhttps://github.com/vuejs/rollup-plugin-vue/issues/303")]),a._v(" "),t("ul",[t("li",[a._v("rollup-plugin-buble 将 es6 语法转化为 es5")]),a._v(" "),t("li",[a._v("rollup-plugin-flow-no-whitespace 去除flow静态类型检查代码")]),a._v(" "),t("li",[a._v("rollup-plugin-alias 为模块提供别名，比如 "),t("code",[a._v("·")]),a._v("const He from 'he'` ，这里的 he 会替换为 alias 的实际名称。")])])])}],!1,null,null,null);s.default=r.exports}}]);